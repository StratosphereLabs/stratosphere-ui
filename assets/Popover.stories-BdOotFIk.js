import{j as re}from"./jsx-runtime-DiklIkkE.js";import{c as Se}from"./index-lhGYx47h.js";import{r as o,R as m}from"./index-DRjF_FHU.js";import{B as Oe}from"./Button-D0Yf2K26.js";import{$ as Me,a as Ne}from"./useFocusRing-CeEfTI_f.js";import{w as _e,e as De}from"./use-resolve-button-type-BunvJ_cM.js";import{y as Le,x as Ae,R as Ke,b as je,d as Ge,M as qe}from"./floating-DbckstqE.js";import{K as X,y as V,b as E,_ as ue,L as ee,n as Je,T as He,s as ye,a as J,O as oe,u as Ue,c as G}from"./keyboard-CkwPyo54.js";import{E as Qe}from"./use-event-listener-B6ZzwbKe.js";import{n as pe,m as Ye,f as Ze,r as Ve,t as We,R as Xe}from"./portal-klmoE2MD.js";import{u as he,b as ze,R as et,O as Ie,a as L}from"./use-tab-direction-CP4NjNZo.js";import{u as xe,x as Te,i as W,R as we,s as tt,c as rt}from"./open-closed-ZYQZnB1s.js";import{C as ot}from"./close-provider-CMV4gi-l.js";import{f as se,s as ie}from"./hidden-VT-llRfc.js";import{r as Ce}from"./bugs-DpEN4NTH.js";import{P as q,F as A,b as de,A as nt,h as at,T as ce}from"./focus-management-BpNHtozA.js";import"./index-Bx0Ph3cE.js";var lt=(e=>(e[e.Open=0]="Open",e[e.Closed=1]="Closed",e))(lt||{}),ut=(e=>(e[e.TogglePopover=0]="TogglePopover",e[e.ClosePopover=1]="ClosePopover",e[e.SetButton=2]="SetButton",e[e.SetButtonId=3]="SetButtonId",e[e.SetPanel=4]="SetPanel",e[e.SetPanelId=5]="SetPanelId",e))(ut||{});let st={0:e=>({...e,popoverState:J(e.popoverState,{0:1,1:0}),__demoMode:!1}),1(e){return e.popoverState===1?e:{...e,popoverState:1,__demoMode:!1}},2(e,n){return e.button===n.button?e:{...e,button:n.button}},3(e,n){return e.buttonId===n.buttonId?e:{...e,buttonId:n.buttonId}},4(e,n){return e.panel===n.panel?e:{...e,panel:n.panel}},5(e,n){return e.panelId===n.panelId?e:{...e,panelId:n.panelId}}},fe=o.createContext(null);fe.displayName="PopoverContext";function ne(e){let n=o.useContext(fe);if(n===null){let c=new Error(`<${e} /> is missing a parent <Popover /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(c,ne),c}return n}let ae=o.createContext(null);ae.displayName="PopoverAPIContext";function ve(e){let n=o.useContext(ae);if(n===null){let c=new Error(`<${e} /> is missing a parent <Popover /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(c,ve),c}return n}let me=o.createContext(null);me.displayName="PopoverGroupContext";function Be(){return o.useContext(me)}let le=o.createContext(null);le.displayName="PopoverPanelContext";function it(){return o.useContext(le)}function ct(e,n){return J(n.type,st,e,n)}let pt="div";function dt(e,n){var c;let{__demoMode:g=!1,...d}=e,y=o.useRef(null),T=V(n,He(u=>{y.current=u})),a=o.useRef([]),v=o.useReducer(ct,{__demoMode:g,popoverState:g?0:1,buttons:a,button:null,buttonId:null,panel:null,panelId:null,beforePanelSentinel:o.createRef(),afterPanelSentinel:o.createRef(),afterButtonSentinel:o.createRef()}),[{popoverState:I,button:r,buttonId:P,panel:f,panelId:$,beforePanelSentinel:h,afterPanelSentinel:b,afterButtonSentinel:l},p]=v,S=pe((c=y.current)!=null?c:r),F=o.useMemo(()=>{if(!r||!f)return!1;for(let x of document.querySelectorAll("body > *"))if(Number(x==null?void 0:x.contains(r))^Number(x==null?void 0:x.contains(f)))return!0;let u=de(),t=u.indexOf(r),i=(t+u.length-1)%u.length,s=(t+1)%u.length,C=u[i],R=u[s];return!f.contains(C)&&!f.contains(R)},[r,f]),k=ye(P),O=ye($),H=o.useMemo(()=>({buttonId:k,panelId:O,close:()=>p({type:1})}),[k,O,p]),M=Be(),w=M==null?void 0:M.registerPopover,K=E(()=>{var u;return(u=M==null?void 0:M.isFocusWithinPopoverGroup())!=null?u:(S==null?void 0:S.activeElement)&&((r==null?void 0:r.contains(S.activeElement))||(f==null?void 0:f.contains(S.activeElement)))});o.useEffect(()=>w==null?void 0:w(H),[w,H]);let[B,U]=We(),j=ze(r),N=et({mainTreeNode:j,portals:B,defaultContainers:[r,f]});Qe(S==null?void 0:S.defaultView,"focus",u=>{var t,i,s,C,R,x;u.target!==window&&u.target instanceof HTMLElement&&I===0&&(K()||r&&f&&(N.contains(u.target)||(i=(t=h.current)==null?void 0:t.contains)!=null&&i.call(t,u.target)||(C=(s=b.current)==null?void 0:s.contains)!=null&&C.call(s,u.target)||(x=(R=l.current)==null?void 0:R.contains)!=null&&x.call(R,u.target)||p({type:1})))},!0),Xe(I===0,N.resolveContainers,(u,t)=>{p({type:1}),nt(t,at.Loose)||(u.preventDefault(),r==null||r.focus())});let _=E(u=>{p({type:1});let t=u?u instanceof HTMLElement?u:"current"in u&&u.current instanceof HTMLElement?u.current:r:r;t==null||t.focus()}),Q=o.useMemo(()=>({close:_,isPortalled:F}),[_,F]),Y=o.useMemo(()=>({open:I===0,close:_}),[I,_]),Z={ref:T},z=ee();return m.createElement(Ie,{node:j},m.createElement(qe,null,m.createElement(le.Provider,{value:null},m.createElement(fe.Provider,{value:v},m.createElement(ae.Provider,{value:Q},m.createElement(ot,{value:_},m.createElement(rt,{value:J(I,{0:W.Open,1:W.Closed})},m.createElement(U,null,z({ourProps:Z,theirProps:d,slot:Y,defaultTag:pt,name:"Popover"})))))))))}let ft="button";function vt(e,n){let c=o.useId(),{id:g=`headlessui-popover-button-${c}`,disabled:d=!1,autoFocus:y=!1,...T}=e,[a,v]=ne("Popover.Button"),{isPortalled:I}=ve("Popover.Button"),r=o.useRef(null),P=`headlessui-focus-sentinel-${o.useId()}`,f=Be(),$=f==null?void 0:f.closeOthers,h=it()!==null;o.useEffect(()=>{if(!h)return v({type:3,buttonId:g}),()=>{v({type:3,buttonId:null})}},[h,g,v]);let[b]=o.useState(()=>Symbol()),l=V(r,n,Le(),E(t=>{if(!h){if(t)a.buttons.current.push(b);else{let i=a.buttons.current.indexOf(b);i!==-1&&a.buttons.current.splice(i,1)}a.buttons.current.length>1&&console.warn("You are already using a <Popover.Button /> but only 1 <Popover.Button /> is supported."),t&&v({type:2,button:t})}})),p=V(r,n),S=pe(r),F=E(t=>{var i,s,C;if(h){if(a.popoverState===1)return;switch(t.key){case G.Space:case G.Enter:t.preventDefault(),(s=(i=t.target).click)==null||s.call(i),v({type:1}),(C=a.button)==null||C.focus();break}}else switch(t.key){case G.Space:case G.Enter:t.preventDefault(),t.stopPropagation(),a.popoverState===1&&($==null||$(a.buttonId)),v({type:0});break;case G.Escape:if(a.popoverState!==0)return $==null?void 0:$(a.buttonId);if(!r.current||S!=null&&S.activeElement&&!r.current.contains(S.activeElement))return;t.preventDefault(),t.stopPropagation(),v({type:1});break}}),k=E(t=>{h||t.key===G.Space&&t.preventDefault()}),O=E(t=>{var i,s;Ce(t.currentTarget)||d||(h?(v({type:1}),(i=a.button)==null||i.focus()):(t.preventDefault(),t.stopPropagation(),a.popoverState===1&&($==null||$(a.buttonId)),v({type:0}),(s=a.button)==null||s.focus()))}),H=E(t=>{t.preventDefault(),t.stopPropagation()}),{isFocusVisible:M,focusProps:w}=Me({autoFocus:y}),{isHovered:K,hoverProps:B}=Ne({isDisabled:d}),{pressed:U,pressProps:j}=_e({disabled:d}),N=a.popoverState===0,_=o.useMemo(()=>({open:N,active:U||N,disabled:d,hover:K,focus:M,autofocus:y}),[N,K,M,U,d,y]),Q=De(e,a.button),Y=h?ue({ref:p,type:Q,onKeyDown:F,onClick:O,disabled:d||void 0,autoFocus:y},w,B,j):ue({ref:l,id:a.buttonId,type:Q,"aria-expanded":a.popoverState===0,"aria-controls":a.panel?a.panelId:void 0,disabled:d||void 0,autoFocus:y,onKeyDown:F,onKeyUp:k,onClick:O,onMouseDown:H},w,B,j),Z=he(),z=E(()=>{let t=a.panel;if(!t)return;function i(){J(Z.current,{[L.Forwards]:()=>q(t,A.First),[L.Backwards]:()=>q(t,A.Last)})===ce.Error&&q(de().filter(s=>s.dataset.headlessuiFocusGuard!=="true"),J(Z.current,{[L.Forwards]:A.Next,[L.Backwards]:A.Previous}),{relativeTo:a.button})}i()}),u=ee();return m.createElement(m.Fragment,null,u({ourProps:Y,theirProps:T,slot:_,defaultTag:ft,name:"Popover.Button"}),N&&!h&&I&&m.createElement(se,{id:P,ref:a.afterButtonSentinel,features:ie.Focusable,"data-headlessui-focus-guard":!0,as:"button",type:"button",onFocus:z}))}let mt="div",Pt=oe.RenderStrategy|oe.Static;function Re(e,n){let c=o.useId(),{id:g=`headlessui-popover-backdrop-${c}`,transition:d=!1,...y}=e,[{popoverState:T},a]=ne("Popover.Backdrop"),[v,I]=o.useState(null),r=V(n,I),P=xe(),[f,$]=Te(d,v,P!==null?(P&W.Open)===W.Open:T===0),h=E(p=>{if(Ce(p.currentTarget))return p.preventDefault();a({type:1})}),b=o.useMemo(()=>({open:T===0}),[T]),l={ref:r,id:g,"aria-hidden":!0,onClick:h,...we($)};return ee()({ourProps:l,theirProps:y,slot:b,defaultTag:mt,features:Pt,visible:f,name:"Popover.Backdrop"})}let bt="div",St=oe.RenderStrategy|oe.Static;function yt(e,n){let c=o.useId(),{id:g=`headlessui-popover-panel-${c}`,focus:d=!1,anchor:y,portal:T=!1,modal:a=!1,transition:v=!1,...I}=e,[r,P]=ne("Popover.Panel"),{close:f,isPortalled:$}=ve("Popover.Panel"),h=`headlessui-focus-sentinel-before-${c}`,b=`headlessui-focus-sentinel-after-${c}`,l=o.useRef(null),p=Ae(y),[S,F]=Ke(p),k=je();p&&(T=!0);let[O,H]=o.useState(null),M=V(l,n,p?S:null,E(t=>P({type:4,panel:t})),H),w=pe(l);Je(()=>(P({type:5,panelId:g}),()=>{P({type:5,panelId:null})}),[g,P]);let K=xe(),[B,U]=Te(v,O,K!==null?(K&W.Open)===W.Open:r.popoverState===0);Ye(B,r.button,()=>{P({type:1})});let j=r.__demoMode?!1:a&&B;Ze(j,w);let N=E(t=>{var i;switch(t.key){case G.Escape:if(r.popoverState!==0||!l.current||w!=null&&w.activeElement&&!l.current.contains(w.activeElement))return;t.preventDefault(),t.stopPropagation(),P({type:1}),(i=r.button)==null||i.focus();break}});o.useEffect(()=>{var t;e.static||r.popoverState===1&&((t=e.unmount)==null||t)&&P({type:4,panel:null})},[r.popoverState,e.unmount,e.static,P]),o.useEffect(()=>{if(r.__demoMode||!d||r.popoverState!==0||!l.current)return;let t=w==null?void 0:w.activeElement;l.current.contains(t)||q(l.current,A.First)},[r.__demoMode,d,l.current,r.popoverState]);let _=o.useMemo(()=>({open:r.popoverState===0,close:f}),[r.popoverState,f]),Q=ue(p?k():{},{ref:M,id:g,onKeyDown:N,onBlur:d&&r.popoverState===0?t=>{var i,s,C,R,x;let D=t.relatedTarget;D&&l.current&&((i=l.current)!=null&&i.contains(D)||(P({type:1}),((C=(s=r.beforePanelSentinel.current)==null?void 0:s.contains)!=null&&C.call(s,D)||(x=(R=r.afterPanelSentinel.current)==null?void 0:R.contains)!=null&&x.call(R,D))&&D.focus({preventScroll:!0})))}:void 0,tabIndex:-1,style:{...I.style,...F,"--button-width":Ge(r.button,!0).width},...we(U)}),Y=he(),Z=E(()=>{let t=l.current;if(!t)return;function i(){J(Y.current,{[L.Forwards]:()=>{var s;q(t,A.First)===ce.Error&&((s=r.afterPanelSentinel.current)==null||s.focus())},[L.Backwards]:()=>{var s;(s=r.button)==null||s.focus({preventScroll:!0})}})}i()}),z=E(()=>{let t=l.current;if(!t)return;function i(){J(Y.current,{[L.Forwards]:()=>{if(!r.button)return;let s=de(),C=s.indexOf(r.button),R=s.slice(0,C+1),x=[...s.slice(C+1),...R];for(let D of x.slice())if(D.dataset.headlessuiFocusGuard==="true"||O!=null&&O.contains(D)){let be=x.indexOf(D);be!==-1&&x.splice(be,1)}q(x,A.First,{sorted:!1})},[L.Backwards]:()=>{var s;q(t,A.Previous)===ce.Error&&((s=r.button)==null||s.focus())}})}i()}),u=ee();return m.createElement(tt,null,m.createElement(le.Provider,{value:g},m.createElement(ae.Provider,{value:{close:f,isPortalled:$}},m.createElement(Ve,{enabled:T?e.static||B:!1},B&&$&&m.createElement(se,{id:h,ref:r.beforePanelSentinel,features:ie.Focusable,"data-headlessui-focus-guard":!0,as:"button",type:"button",onFocus:Z}),u({ourProps:Q,theirProps:I,slot:_,defaultTag:bt,features:St,visible:B,name:"Popover.Panel"}),B&&$&&m.createElement(se,{id:b,ref:r.afterPanelSentinel,features:ie.Focusable,"data-headlessui-focus-guard":!0,as:"button",type:"button",onFocus:z})))))}let Et="div";function gt(e,n){let c=o.useRef(null),g=V(c,n),[d,y]=o.useState([]),T=E(b=>{y(l=>{let p=l.indexOf(b);if(p!==-1){let S=l.slice();return S.splice(p,1),S}return l})}),a=E(b=>(y(l=>[...l,b]),()=>T(b))),v=E(()=>{var b;let l=Ue(c);if(!l)return!1;let p=l.activeElement;return(b=c.current)!=null&&b.contains(p)?!0:d.some(S=>{var F,k;return((F=l.getElementById(S.buttonId.current))==null?void 0:F.contains(p))||((k=l.getElementById(S.panelId.current))==null?void 0:k.contains(p))})}),I=E(b=>{for(let l of d)l.buttonId.current!==b&&l.close()}),r=o.useMemo(()=>({registerPopover:a,unregisterPopover:T,isFocusWithinPopoverGroup:v,closeOthers:I}),[a,T,v,I]),P=o.useMemo(()=>({}),[]),f=e,$={ref:g},h=ee();return m.createElement(Ie,null,m.createElement(me.Provider,{value:r},h({ourProps:$,theirProps:f,slot:P,defaultTag:Et,name:"Popover.Group"})))}let $t=X(dt),Fe=X(vt),ht=X(Re),It=X(Re),ke=X(yt),xt=X(gt),Tt=Object.assign($t,{Button:Fe,Backdrop:It,Overlay:ht,Panel:ke,Group:xt});const Pe=o.forwardRef(({anchor:e,buttonProps:n,className:c,popoverClassName:g,popoverComponent:d},y)=>re.jsxs(Tt,{ref:y,children:[re.jsx(Fe,{as:Oe,className:Se(c,n.className),...n}),re.jsx(ke,{as:"div",anchor:e??"bottom start",transition:!0,className:Se("flex origin-top flex-col p-2 shadow-xl transition duration-200 ease-out data-[closed]:scale-95 data-[closed]:opacity-0",g),children:d})]}));Pe.displayName="Popover";Pe.__docgenInfo={description:"",methods:[],displayName:"Popover",props:{anchor:{required:!1,tsType:{name:"AnchorProps"},description:""},buttonProps:{required:!0,tsType:{name:"ButtonProps"},description:""},className:{required:!1,tsType:{name:"string"},description:""},popoverClassName:{required:!1,tsType:{name:"string"},description:""},popoverComponent:{required:!0,tsType:{name:"signature",type:"function",raw:"({ open, close }: PopoverPanelRenderProps) => JSX.Element",signature:{arguments:[{type:{name:"PopoverPanelRenderProps"},name:""}],return:{name:"JSX.Element"}}},description:""}},composes:["Omit"]};const Jt={title:"Popover",component:Pe},te={args:{buttonProps:{children:"Open Popover"},className:"mb-24",popoverComponent:()=>re.jsx("div",{className:"w-64",children:"Test Lmao"})}};var Ee,ge,$e;te.parameters={...te.parameters,docs:{...(Ee=te.parameters)==null?void 0:Ee.docs,source:{originalSource:`{
  args: {
    buttonProps: {
      children: 'Open Popover'
    },
    className: 'mb-24',
    popoverComponent: () => <div className="w-64">Test Lmao</div>
  }
}`,...($e=(ge=te.parameters)==null?void 0:ge.docs)==null?void 0:$e.source}}};const Ht=["Default"];export{te as Default,Ht as __namedExportsOrder,Jt as default};
