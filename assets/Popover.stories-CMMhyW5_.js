import{j as q}from"./jsx-runtime-DR9Q75dM.js";import{c as ge}from"./index-lhGYx47h.js";import{r as o,R as v}from"./index-DRjF_FHU.js";import{B as _e}from"./Button-C8Er2sLW.js";import{$ as De,a as Le}from"./useFocusRing-Bmn-zFZf.js";import{w as je,e as Ae}from"./use-resolve-button-type-CNcqzI1Z.js";import{M as Ke,y as Ge,x as qe,R as Je,b as He,d as Ue}from"./floating-DlhN9gcG.js";import{O as ae,K as X,y as Z,T as We,s as Ee,o as g,L as te,u as H,_ as ie,n as ze,c as G,a as Qe}from"./keyboard-CUk6zo9K.js";import{E as Ye}from"./use-event-listener-h_Uk4X8M.js";import{n as me,t as Ze,R as Ve,m as Xe,f as et,r as tt}from"./portal-ddnK3kf1.js";import{b as rt,R as ot,O as Be,u as Ce,a as L}from"./use-tab-direction-c-FT5Us1.js";import{c as nt,i as V,u as ke,x as Fe,R as Oe,s as at}from"./use-server-handoff-complete-BT_ig_8b.js";import{C as lt}from"./close-provider-CfqLQYnm.js";import{f as pe,s as ce}from"./hidden-ZETsWED3.js";import{r as Re}from"./bugs-DpEN4NTH.js";import{b as fe,P as J,F as j,A as st,h as ut,T as de}from"./focus-management-BR9cTPnt.js";import{z as it}from"./transition-DrHXcrLQ.js";import"./index-rX-Bn4lm.js";import"./use-is-mounted-DBJHk9C2.js";var pt=(e=>(e[e.Open=0]="Open",e[e.Closed=1]="Closed",e))(pt||{}),ct=(e=>(e[e.TogglePopover=0]="TogglePopover",e[e.ClosePopover=1]="ClosePopover",e[e.SetButton=2]="SetButton",e[e.SetButtonId=3]="SetButtonId",e[e.SetPanel=4]="SetPanel",e[e.SetPanelId=5]="SetPanelId",e))(ct||{});let dt={0:e=>({...e,popoverState:H(e.popoverState,{0:1,1:0}),__demoMode:!1}),1(e){return e.popoverState===1?e:{...e,popoverState:1,__demoMode:!1}},2(e,n){return e.button===n.button?e:{...e,button:n.button}},3(e,n){return e.buttonId===n.buttonId?e:{...e,buttonId:n.buttonId}},4(e,n){return e.panel===n.panel?e:{...e,panel:n.panel}},5(e,n){return e.panelId===n.panelId?e:{...e,panelId:n.panelId}}},ve=o.createContext(null);ve.displayName="PopoverContext";function le(e){let n=o.useContext(ve);if(n===null){let p=new Error(`<${e} /> is missing a parent <Popover /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(p,le),p}return n}let se=o.createContext(null);se.displayName="PopoverAPIContext";function Pe(e){let n=o.useContext(se);if(n===null){let p=new Error(`<${e} /> is missing a parent <Popover /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(p,Pe),p}return n}let be=o.createContext(null);be.displayName="PopoverGroupContext";function Ne(){return o.useContext(be)}let ue=o.createContext(null);ue.displayName="PopoverPanelContext";function mt(){return o.useContext(ue)}function ft(e,n){return H(n.type,dt,e,n)}let vt="div";function Pt(e,n){var p;let{__demoMode:E=!1,...d}=e,y=o.useRef(null),h=Z(n,We(s=>{y.current=s})),a=o.useRef([]),f=o.useReducer(ft,{__demoMode:E,popoverState:E?0:1,buttons:a,button:null,buttonId:null,panel:null,panelId:null,beforePanelSentinel:o.createRef(),afterPanelSentinel:o.createRef(),afterButtonSentinel:o.createRef()}),[{popoverState:I,button:r,buttonId:P,panel:m,panelId:$,beforePanelSentinel:x,afterPanelSentinel:b,afterButtonSentinel:l},c]=f,S=me((p=y.current)!=null?p:r),F=o.useMemo(()=>{if(!r||!m)return!1;for(let w of document.querySelectorAll("body > *"))if(Number(w==null?void 0:w.contains(r))^Number(w==null?void 0:w.contains(m)))return!0;let s=fe(),t=s.indexOf(r),i=(t+s.length-1)%s.length,u=(t+1)%s.length,B=s[i],k=s[u];return!m.contains(B)&&!m.contains(k)},[r,m]),O=Ee(P),R=Ee($),U=o.useMemo(()=>({buttonId:O,panelId:R,close:()=>c({type:1})}),[O,R,c]),N=Ne(),T=N==null?void 0:N.registerPopover,A=g(()=>{var s;return(s=N==null?void 0:N.isFocusWithinPopoverGroup())!=null?s:(S==null?void 0:S.activeElement)&&((r==null?void 0:r.contains(S.activeElement))||(m==null?void 0:m.contains(S.activeElement)))});o.useEffect(()=>T==null?void 0:T(U),[T,U]);let[C,W]=Ze(),K=rt(r),M=ot({mainTreeNode:K,portals:C,defaultContainers:[r,m]});Ye(S==null?void 0:S.defaultView,"focus",s=>{var t,i,u,B,k,w;s.target!==window&&s.target instanceof HTMLElement&&I===0&&(A()||r&&m&&(M.contains(s.target)||(i=(t=x.current)==null?void 0:t.contains)!=null&&i.call(t,s.target)||(B=(u=b.current)==null?void 0:u.contains)!=null&&B.call(u,s.target)||(w=(k=l.current)==null?void 0:k.contains)!=null&&w.call(k,s.target)||c({type:1})))},!0),Ve(I===0,M.resolveContainers,(s,t)=>{c({type:1}),st(t,ut.Loose)||(s.preventDefault(),r==null||r.focus())});let _=g(s=>{c({type:1});let t=s?s instanceof HTMLElement?s:"current"in s&&s.current instanceof HTMLElement?s.current:r:r;t==null||t.focus()}),z=o.useMemo(()=>({close:_,isPortalled:F}),[_,F]),Q=o.useMemo(()=>({open:I===0,close:_}),[I,_]),Y={ref:h},ee=te();return v.createElement(Be,{node:K},v.createElement(Ke,null,v.createElement(ue.Provider,{value:null},v.createElement(ve.Provider,{value:f},v.createElement(se.Provider,{value:z},v.createElement(lt,{value:_},v.createElement(nt,{value:H(I,{0:V.Open,1:V.Closed})},v.createElement(W,null,ee({ourProps:Y,theirProps:d,slot:Q,defaultTag:vt,name:"Popover"})))))))))}let bt="button";function St(e,n){let p=o.useId(),{id:E=`headlessui-popover-button-${p}`,disabled:d=!1,autoFocus:y=!1,...h}=e,[a,f]=le("Popover.Button"),{isPortalled:I}=Pe("Popover.Button"),r=o.useRef(null),P=`headlessui-focus-sentinel-${o.useId()}`,m=Ne(),$=m==null?void 0:m.closeOthers,x=mt()!==null;o.useEffect(()=>{if(!x)return f({type:3,buttonId:E}),()=>{f({type:3,buttonId:null})}},[x,E,f]);let[b]=o.useState(()=>Symbol()),l=Z(r,n,Ge(),g(t=>{if(!x){if(t)a.buttons.current.push(b);else{let i=a.buttons.current.indexOf(b);i!==-1&&a.buttons.current.splice(i,1)}a.buttons.current.length>1&&console.warn("You are already using a <Popover.Button /> but only 1 <Popover.Button /> is supported."),t&&f({type:2,button:t})}})),c=Z(r,n),S=me(r),F=g(t=>{var i,u,B;if(x){if(a.popoverState===1)return;switch(t.key){case G.Space:case G.Enter:t.preventDefault(),(u=(i=t.target).click)==null||u.call(i),f({type:1}),(B=a.button)==null||B.focus();break}}else switch(t.key){case G.Space:case G.Enter:t.preventDefault(),t.stopPropagation(),a.popoverState===1&&($==null||$(a.buttonId)),f({type:0});break;case G.Escape:if(a.popoverState!==0)return $==null?void 0:$(a.buttonId);if(!r.current||S!=null&&S.activeElement&&!r.current.contains(S.activeElement))return;t.preventDefault(),t.stopPropagation(),f({type:1});break}}),O=g(t=>{x||t.key===G.Space&&t.preventDefault()}),R=g(t=>{var i,u;Re(t.currentTarget)||d||(x?(f({type:1}),(i=a.button)==null||i.focus()):(t.preventDefault(),t.stopPropagation(),a.popoverState===1&&($==null||$(a.buttonId)),f({type:0}),(u=a.button)==null||u.focus()))}),U=g(t=>{t.preventDefault(),t.stopPropagation()}),{isFocusVisible:N,focusProps:T}=De({autoFocus:y}),{isHovered:A,hoverProps:C}=Le({isDisabled:d}),{pressed:W,pressProps:K}=je({disabled:d}),M=a.popoverState===0,_=o.useMemo(()=>({open:M,active:W||M,disabled:d,hover:A,focus:N,autofocus:y}),[M,A,N,W,d,y]),z=Ae(e,a.button),Q=x?ie({ref:c,type:z,onKeyDown:F,onClick:R,disabled:d||void 0,autoFocus:y},T,C,K):ie({ref:l,id:a.buttonId,type:z,"aria-expanded":a.popoverState===0,"aria-controls":a.panel?a.panelId:void 0,disabled:d||void 0,autoFocus:y,onKeyDown:F,onKeyUp:O,onClick:R,onMouseDown:U},T,C,K),Y=Ce(),ee=g(()=>{let t=a.panel;if(!t)return;function i(){H(Y.current,{[L.Forwards]:()=>J(t,j.First),[L.Backwards]:()=>J(t,j.Last)})===de.Error&&J(fe().filter(u=>u.dataset.headlessuiFocusGuard!=="true"),H(Y.current,{[L.Forwards]:j.Next,[L.Backwards]:j.Previous}),{relativeTo:a.button})}i()}),s=te();return v.createElement(v.Fragment,null,s({ourProps:Q,theirProps:h,slot:_,defaultTag:bt,name:"Popover.Button"}),M&&!x&&I&&v.createElement(pe,{id:P,ref:a.afterButtonSentinel,features:ce.Focusable,"data-headlessui-focus-guard":!0,as:"button",type:"button",onFocus:ee}))}let yt="div",gt=ae.RenderStrategy|ae.Static;function Me(e,n){let p=o.useId(),{id:E=`headlessui-popover-backdrop-${p}`,transition:d=!1,...y}=e,[{popoverState:h},a]=le("Popover.Backdrop"),[f,I]=o.useState(null),r=Z(n,I),P=ke(),[m,$]=Fe(d,f,P!==null?(P&V.Open)===V.Open:h===0),x=g(c=>{if(Re(c.currentTarget))return c.preventDefault();a({type:1})}),b=o.useMemo(()=>({open:h===0}),[h]),l={ref:r,id:E,"aria-hidden":!0,onClick:x,...Oe($)};return te()({ourProps:l,theirProps:y,slot:b,defaultTag:yt,features:gt,visible:m,name:"Popover.Backdrop"})}let Et="div",ht=ae.RenderStrategy|ae.Static;function $t(e,n){let p=o.useId(),{id:E=`headlessui-popover-panel-${p}`,focus:d=!1,anchor:y,portal:h=!1,modal:a=!1,transition:f=!1,...I}=e,[r,P]=le("Popover.Panel"),{close:m,isPortalled:$}=Pe("Popover.Panel"),x=`headlessui-focus-sentinel-before-${p}`,b=`headlessui-focus-sentinel-after-${p}`,l=o.useRef(null),c=qe(y),[S,F]=Je(c),O=He();c&&(h=!0);let[R,U]=o.useState(null),N=Z(l,n,c?S:null,g(t=>P({type:4,panel:t})),U),T=me(l);ze(()=>(P({type:5,panelId:E}),()=>{P({type:5,panelId:null})}),[E,P]);let A=ke(),[C,W]=Fe(f,R,A!==null?(A&V.Open)===V.Open:r.popoverState===0);Xe(C,r.button,()=>{P({type:1})});let K=r.__demoMode?!1:a&&C;et(K,T);let M=g(t=>{var i;switch(t.key){case G.Escape:if(r.popoverState!==0||!l.current||T!=null&&T.activeElement&&!l.current.contains(T.activeElement))return;t.preventDefault(),t.stopPropagation(),P({type:1}),(i=r.button)==null||i.focus();break}});o.useEffect(()=>{var t;e.static||r.popoverState===1&&((t=e.unmount)==null||t)&&P({type:4,panel:null})},[r.popoverState,e.unmount,e.static,P]),o.useEffect(()=>{if(r.__demoMode||!d||r.popoverState!==0||!l.current)return;let t=T==null?void 0:T.activeElement;l.current.contains(t)||J(l.current,j.First)},[r.__demoMode,d,l.current,r.popoverState]);let _=o.useMemo(()=>({open:r.popoverState===0,close:m}),[r.popoverState,m]),z=ie(c?O():{},{ref:N,id:E,onKeyDown:M,onBlur:d&&r.popoverState===0?t=>{var i,u,B,k,w;let D=t.relatedTarget;D&&l.current&&((i=l.current)!=null&&i.contains(D)||(P({type:1}),((B=(u=r.beforePanelSentinel.current)==null?void 0:u.contains)!=null&&B.call(u,D)||(w=(k=r.afterPanelSentinel.current)==null?void 0:k.contains)!=null&&w.call(k,D))&&D.focus({preventScroll:!0})))}:void 0,tabIndex:-1,style:{...I.style,...F,"--button-width":Ue(r.button,!0).width},...Oe(W)}),Q=Ce(),Y=g(()=>{let t=l.current;if(!t)return;function i(){H(Q.current,{[L.Forwards]:()=>{var u;J(t,j.First)===de.Error&&((u=r.afterPanelSentinel.current)==null||u.focus())},[L.Backwards]:()=>{var u;(u=r.button)==null||u.focus({preventScroll:!0})}})}i()}),ee=g(()=>{let t=l.current;if(!t)return;function i(){H(Q.current,{[L.Forwards]:()=>{if(!r.button)return;let u=fe(),B=u.indexOf(r.button),k=u.slice(0,B+1),w=[...u.slice(B+1),...k];for(let D of w.slice())if(D.dataset.headlessuiFocusGuard==="true"||R!=null&&R.contains(D)){let ye=w.indexOf(D);ye!==-1&&w.splice(ye,1)}J(w,j.First,{sorted:!1})},[L.Backwards]:()=>{var u;J(t,j.Previous)===de.Error&&((u=r.button)==null||u.focus())}})}i()}),s=te();return v.createElement(at,null,v.createElement(ue.Provider,{value:E},v.createElement(se.Provider,{value:{close:m,isPortalled:$}},v.createElement(tt,{enabled:h?e.static||C:!1},C&&$&&v.createElement(pe,{id:x,ref:r.beforePanelSentinel,features:ce.Focusable,"data-headlessui-focus-guard":!0,as:"button",type:"button",onFocus:Y}),s({ourProps:z,theirProps:I,slot:_,defaultTag:Et,features:ht,visible:C,name:"Popover.Panel"}),C&&$&&v.createElement(pe,{id:b,ref:r.afterPanelSentinel,features:ce.Focusable,"data-headlessui-focus-guard":!0,as:"button",type:"button",onFocus:ee})))))}let xt="div";function It(e,n){let p=o.useRef(null),E=Z(p,n),[d,y]=o.useState([]),h=g(b=>{y(l=>{let c=l.indexOf(b);if(c!==-1){let S=l.slice();return S.splice(c,1),S}return l})}),a=g(b=>(y(l=>[...l,b]),()=>h(b))),f=g(()=>{var b;let l=Qe(p);if(!l)return!1;let c=l.activeElement;return(b=p.current)!=null&&b.contains(c)?!0:d.some(S=>{var F,O;return((F=l.getElementById(S.buttonId.current))==null?void 0:F.contains(c))||((O=l.getElementById(S.panelId.current))==null?void 0:O.contains(c))})}),I=g(b=>{for(let l of d)l.buttonId.current!==b&&l.close()}),r=o.useMemo(()=>({registerPopover:a,unregisterPopover:h,isFocusWithinPopoverGroup:f,closeOthers:I}),[a,h,f,I]),P=o.useMemo(()=>({}),[]),m=e,$={ref:E},x=te();return v.createElement(Be,null,v.createElement(be.Provider,{value:r},x({ourProps:$,theirProps:m,slot:P,defaultTag:xt,name:"Popover.Group"})))}let wt=X(Pt),Tt=X(St),Bt=X(Me),Ct=X(Me),kt=X($t),Ft=X(It),re=Object.assign(wt,{Button:Tt,Backdrop:Ct,Overlay:Bt,Panel:kt,Group:Ft});const Se=o.forwardRef(({buttonProps:e,className:n,popoverClassName:p,popoverComponent:E,withBackdrop:d,...y},h)=>q.jsxs(re,{as:"div",className:ge("relative",n),ref:h,...y,children:[q.jsx(re.Button,{as:_e,...e}),d?q.jsx(re.Overlay,{className:"fixed inset-0 bg-black opacity-30"}):null,q.jsx(it,{as:o.Fragment,enter:"transition duration-100 ease-out",enterFrom:"transform scale-95 opacity-0",enterTo:"transform scale-100 opacity-100",leave:"transition duration-75 ease-out",leaveFrom:"transform scale-100 opacity-100",leaveTo:"transform scale-95 opacity-0",children:q.jsx(re.Panel,{as:"div",className:ge("absolute z-50 bg-base-100 p-2 shadow-xl",p),children:E})})]}));Se.displayName="Popover";Se.__docgenInfo={description:"",methods:[],displayName:"Popover",props:{buttonProps:{required:!0,tsType:{name:"ButtonProps"},description:""},className:{required:!1,tsType:{name:"string"},description:""},popoverClassName:{required:!1,tsType:{name:"string"},description:""},popoverComponent:{required:!0,tsType:{name:"signature",type:"function",raw:"({ open, close }: PopoverPanelRenderProps) => JSX.Element",signature:{arguments:[{type:{name:"PopoverPanelRenderProps"},name:""}],return:{name:"JSX.Element"}}},description:""},withBackdrop:{required:!1,tsType:{name:"boolean"},description:""}},composes:["Omit"]};const Zt={title:"Popover",component:Se},oe={args:{buttonProps:{children:"Open Popover"},className:"mb-24",popoverComponent:()=>q.jsx("div",{className:"w-64",children:"Test Lmao"})}},ne={args:{buttonProps:{children:"Open Popover"},className:"mb-24",popoverComponent:()=>q.jsx("div",{className:"w-64",children:"Test Lmao"}),withBackdrop:!0}};var he,$e,xe;oe.parameters={...oe.parameters,docs:{...(he=oe.parameters)==null?void 0:he.docs,source:{originalSource:`{
  args: {
    buttonProps: {
      children: 'Open Popover'
    },
    className: 'mb-24',
    popoverComponent: () => <div className="w-64">Test Lmao</div>
  }
}`,...(xe=($e=oe.parameters)==null?void 0:$e.docs)==null?void 0:xe.source}}};var Ie,we,Te;ne.parameters={...ne.parameters,docs:{...(Ie=ne.parameters)==null?void 0:Ie.docs,source:{originalSource:`{
  args: {
    buttonProps: {
      children: 'Open Popover'
    },
    className: 'mb-24',
    popoverComponent: () => <div className="w-64">Test Lmao</div>,
    withBackdrop: true
  }
}`,...(Te=(we=ne.parameters)==null?void 0:we.docs)==null?void 0:Te.source}}};const Vt=["Default","WithBackdrop"];export{oe as Default,ne as WithBackdrop,Vt as __namedExportsOrder,Zt as default};
