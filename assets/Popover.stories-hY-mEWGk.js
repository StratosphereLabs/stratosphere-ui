import{j as re}from"./jsx-runtime-DiklIkkE.js";import{c as ke}from"./index-lhGYx47h.js";import{r as o,R as m}from"./index-DRjF_FHU.js";import{B as Oe}from"./Button-D0Yf2K26.js";import{$ as Me,a as _e}from"./useFocusRing-CeEfTI_f.js";import{w as Ne,e as De}from"./use-resolve-button-type-BunvJ_cM.js";import{y as Le,x as Ae,R as Ke,b as je,d as qe,M as Ge}from"./floating-DbckstqE.js";import{K as X,y as V,b as E,_ as ue,L as ee,n as Je,T as He,s as Se,a as J,O as oe,u as Ue,c as q}from"./keyboard-CkwPyo54.js";import{E as Qe}from"./use-event-listener-B6ZzwbKe.js";import{n as ce,m as Ye,f as Ze,r as Ve,t as We,R as Xe}from"./portal-klmoE2MD.js";import{u as $e,b as ze,R as et,O as he,a as L}from"./use-tab-direction-CP4NjNZo.js";import{u as Ie,x as xe,i as W,R as Te,s as tt,c as rt}from"./open-closed-ZYQZnB1s.js";import{C as ot}from"./close-provider-CMV4gi-l.js";import{f as se,s as ie}from"./hidden-VT-llRfc.js";import{r as we}from"./bugs-DpEN4NTH.js";import{P as G,F as A,b as de,A as nt,h as at,T as pe}from"./focus-management-BpNHtozA.js";import"./index-Bx0Ph3cE.js";var lt=(e=>(e[e.Open=0]="Open",e[e.Closed=1]="Closed",e))(lt||{}),ut=(e=>(e[e.TogglePopover=0]="TogglePopover",e[e.ClosePopover=1]="ClosePopover",e[e.SetButton=2]="SetButton",e[e.SetButtonId=3]="SetButtonId",e[e.SetPanel=4]="SetPanel",e[e.SetPanelId=5]="SetPanelId",e))(ut||{});let st={0:e=>({...e,popoverState:J(e.popoverState,{0:1,1:0}),__demoMode:!1}),1(e){return e.popoverState===1?e:{...e,popoverState:1,__demoMode:!1}},2(e,n){return e.button===n.button?e:{...e,button:n.button}},3(e,n){return e.buttonId===n.buttonId?e:{...e,buttonId:n.buttonId}},4(e,n){return e.panel===n.panel?e:{...e,panel:n.panel}},5(e,n){return e.panelId===n.panelId?e:{...e,panelId:n.panelId}}},fe=o.createContext(null);fe.displayName="PopoverContext";function ne(e){let n=o.useContext(fe);if(n===null){let p=new Error(`<${e} /> is missing a parent <Popover /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(p,ne),p}return n}let ae=o.createContext(null);ae.displayName="PopoverAPIContext";function ve(e){let n=o.useContext(ae);if(n===null){let p=new Error(`<${e} /> is missing a parent <Popover /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(p,ve),p}return n}let me=o.createContext(null);me.displayName="PopoverGroupContext";function Ce(){return o.useContext(me)}let le=o.createContext(null);le.displayName="PopoverPanelContext";function it(){return o.useContext(le)}function pt(e,n){return J(n.type,st,e,n)}let ct="div";function dt(e,n){var p;let{__demoMode:g=!1,...d}=e,y=o.useRef(null),$=V(n,He(u=>{y.current=u})),a=o.useRef([]),v=o.useReducer(pt,{__demoMode:g,popoverState:g?0:1,buttons:a,button:null,buttonId:null,panel:null,panelId:null,beforePanelSentinel:o.createRef(),afterPanelSentinel:o.createRef(),afterButtonSentinel:o.createRef()}),[{popoverState:x,button:r,buttonId:P,panel:f,panelId:h,beforePanelSentinel:I,afterPanelSentinel:b,afterButtonSentinel:l},c]=v,S=ce((p=y.current)!=null?p:r),F=o.useMemo(()=>{if(!r||!f)return!1;for(let T of document.querySelectorAll("body > *"))if(Number(T==null?void 0:T.contains(r))^Number(T==null?void 0:T.contains(f)))return!0;let u=de(),t=u.indexOf(r),i=(t+u.length-1)%u.length,s=(t+1)%u.length,C=u[i],R=u[s];return!f.contains(C)&&!f.contains(R)},[r,f]),k=Se(P),O=Se(h),H=o.useMemo(()=>({buttonId:k,panelId:O,close:()=>c({type:1})}),[k,O,c]),M=Ce(),w=M==null?void 0:M.registerPopover,K=E(()=>{var u;return(u=M==null?void 0:M.isFocusWithinPopoverGroup())!=null?u:(S==null?void 0:S.activeElement)&&((r==null?void 0:r.contains(S.activeElement))||(f==null?void 0:f.contains(S.activeElement)))});o.useEffect(()=>w==null?void 0:w(H),[w,H]);let[B,U]=We(),j=ze(r),_=et({mainTreeNode:j,portals:B,defaultContainers:[r,f]});Qe(S==null?void 0:S.defaultView,"focus",u=>{var t,i,s,C,R,T;u.target!==window&&u.target instanceof HTMLElement&&x===0&&(K()||r&&f&&(_.contains(u.target)||(i=(t=I.current)==null?void 0:t.contains)!=null&&i.call(t,u.target)||(C=(s=b.current)==null?void 0:s.contains)!=null&&C.call(s,u.target)||(T=(R=l.current)==null?void 0:R.contains)!=null&&T.call(R,u.target)||c({type:1})))},!0),Xe(x===0,_.resolveContainers,(u,t)=>{c({type:1}),nt(t,at.Loose)||(u.preventDefault(),r==null||r.focus())});let N=E(u=>{c({type:1});let t=u?u instanceof HTMLElement?u:"current"in u&&u.current instanceof HTMLElement?u.current:r:r;t==null||t.focus()}),Q=o.useMemo(()=>({close:N,isPortalled:F}),[N,F]),Y=o.useMemo(()=>({open:x===0,close:N}),[x,N]),Z={ref:$},z=ee();return m.createElement(he,{node:j},m.createElement(Ge,null,m.createElement(le.Provider,{value:null},m.createElement(fe.Provider,{value:v},m.createElement(ae.Provider,{value:Q},m.createElement(ot,{value:N},m.createElement(rt,{value:J(x,{0:W.Open,1:W.Closed})},m.createElement(U,null,z({ourProps:Z,theirProps:d,slot:Y,defaultTag:ct,name:"Popover"})))))))))}let ft="button";function vt(e,n){let p=o.useId(),{id:g=`headlessui-popover-button-${p}`,disabled:d=!1,autoFocus:y=!1,...$}=e,[a,v]=ne("Popover.Button"),{isPortalled:x}=ve("Popover.Button"),r=o.useRef(null),P=`headlessui-focus-sentinel-${o.useId()}`,f=Ce(),h=f==null?void 0:f.closeOthers,I=it()!==null;o.useEffect(()=>{if(!I)return v({type:3,buttonId:g}),()=>{v({type:3,buttonId:null})}},[I,g,v]);let[b]=o.useState(()=>Symbol()),l=V(r,n,Le(),E(t=>{if(!I){if(t)a.buttons.current.push(b);else{let i=a.buttons.current.indexOf(b);i!==-1&&a.buttons.current.splice(i,1)}a.buttons.current.length>1&&console.warn("You are already using a <Popover.Button /> but only 1 <Popover.Button /> is supported."),t&&v({type:2,button:t})}})),c=V(r,n),S=ce(r),F=E(t=>{var i,s,C;if(I){if(a.popoverState===1)return;switch(t.key){case q.Space:case q.Enter:t.preventDefault(),(s=(i=t.target).click)==null||s.call(i),v({type:1}),(C=a.button)==null||C.focus();break}}else switch(t.key){case q.Space:case q.Enter:t.preventDefault(),t.stopPropagation(),a.popoverState===1&&(h==null||h(a.buttonId)),v({type:0});break;case q.Escape:if(a.popoverState!==0)return h==null?void 0:h(a.buttonId);if(!r.current||S!=null&&S.activeElement&&!r.current.contains(S.activeElement))return;t.preventDefault(),t.stopPropagation(),v({type:1});break}}),k=E(t=>{I||t.key===q.Space&&t.preventDefault()}),O=E(t=>{var i,s;we(t.currentTarget)||d||(I?(v({type:1}),(i=a.button)==null||i.focus()):(t.preventDefault(),t.stopPropagation(),a.popoverState===1&&(h==null||h(a.buttonId)),v({type:0}),(s=a.button)==null||s.focus()))}),H=E(t=>{t.preventDefault(),t.stopPropagation()}),{isFocusVisible:M,focusProps:w}=Me({autoFocus:y}),{isHovered:K,hoverProps:B}=_e({isDisabled:d}),{pressed:U,pressProps:j}=Ne({disabled:d}),_=a.popoverState===0,N=o.useMemo(()=>({open:_,active:U||_,disabled:d,hover:K,focus:M,autofocus:y}),[_,K,M,U,d,y]),Q=De(e,a.button),Y=I?ue({ref:c,type:Q,onKeyDown:F,onClick:O,disabled:d||void 0,autoFocus:y},w,B,j):ue({ref:l,id:a.buttonId,type:Q,"aria-expanded":a.popoverState===0,"aria-controls":a.panel?a.panelId:void 0,disabled:d||void 0,autoFocus:y,onKeyDown:F,onKeyUp:k,onClick:O,onMouseDown:H},w,B,j),Z=$e(),z=E(()=>{let t=a.panel;if(!t)return;function i(){J(Z.current,{[L.Forwards]:()=>G(t,A.First),[L.Backwards]:()=>G(t,A.Last)})===pe.Error&&G(de().filter(s=>s.dataset.headlessuiFocusGuard!=="true"),J(Z.current,{[L.Forwards]:A.Next,[L.Backwards]:A.Previous}),{relativeTo:a.button})}i()}),u=ee();return m.createElement(m.Fragment,null,u({ourProps:Y,theirProps:$,slot:N,defaultTag:ft,name:"Popover.Button"}),_&&!I&&x&&m.createElement(se,{id:P,ref:a.afterButtonSentinel,features:ie.Focusable,"data-headlessui-focus-guard":!0,as:"button",type:"button",onFocus:z}))}let mt="div",Pt=oe.RenderStrategy|oe.Static;function Be(e,n){let p=o.useId(),{id:g=`headlessui-popover-backdrop-${p}`,transition:d=!1,...y}=e,[{popoverState:$},a]=ne("Popover.Backdrop"),[v,x]=o.useState(null),r=V(n,x),P=Ie(),[f,h]=xe(d,v,P!==null?(P&W.Open)===W.Open:$===0),I=E(c=>{if(we(c.currentTarget))return c.preventDefault();a({type:1})}),b=o.useMemo(()=>({open:$===0}),[$]),l={ref:r,id:g,"aria-hidden":!0,onClick:I,...Te(h)};return ee()({ourProps:l,theirProps:y,slot:b,defaultTag:mt,features:Pt,visible:f,name:"Popover.Backdrop"})}let bt="div",St=oe.RenderStrategy|oe.Static;function yt(e,n){let p=o.useId(),{id:g=`headlessui-popover-panel-${p}`,focus:d=!1,anchor:y,portal:$=!1,modal:a=!1,transition:v=!1,...x}=e,[r,P]=ne("Popover.Panel"),{close:f,isPortalled:h}=ve("Popover.Panel"),I=`headlessui-focus-sentinel-before-${p}`,b=`headlessui-focus-sentinel-after-${p}`,l=o.useRef(null),c=Ae(y),[S,F]=Ke(c),k=je();c&&($=!0);let[O,H]=o.useState(null),M=V(l,n,c?S:null,E(t=>P({type:4,panel:t})),H),w=ce(l);Je(()=>(P({type:5,panelId:g}),()=>{P({type:5,panelId:null})}),[g,P]);let K=Ie(),[B,U]=xe(v,O,K!==null?(K&W.Open)===W.Open:r.popoverState===0);Ye(B,r.button,()=>{P({type:1})});let j=r.__demoMode?!1:a&&B;Ze(j,w);let _=E(t=>{var i;switch(t.key){case q.Escape:if(r.popoverState!==0||!l.current||w!=null&&w.activeElement&&!l.current.contains(w.activeElement))return;t.preventDefault(),t.stopPropagation(),P({type:1}),(i=r.button)==null||i.focus();break}});o.useEffect(()=>{var t;e.static||r.popoverState===1&&((t=e.unmount)==null||t)&&P({type:4,panel:null})},[r.popoverState,e.unmount,e.static,P]),o.useEffect(()=>{if(r.__demoMode||!d||r.popoverState!==0||!l.current)return;let t=w==null?void 0:w.activeElement;l.current.contains(t)||G(l.current,A.First)},[r.__demoMode,d,l.current,r.popoverState]);let N=o.useMemo(()=>({open:r.popoverState===0,close:f}),[r.popoverState,f]),Q=ue(c?k():{},{ref:M,id:g,onKeyDown:_,onBlur:d&&r.popoverState===0?t=>{var i,s,C,R,T;let D=t.relatedTarget;D&&l.current&&((i=l.current)!=null&&i.contains(D)||(P({type:1}),((C=(s=r.beforePanelSentinel.current)==null?void 0:s.contains)!=null&&C.call(s,D)||(T=(R=r.afterPanelSentinel.current)==null?void 0:R.contains)!=null&&T.call(R,D))&&D.focus({preventScroll:!0})))}:void 0,tabIndex:-1,style:{...x.style,...F,"--button-width":qe(r.button,!0).width},...Te(U)}),Y=$e(),Z=E(()=>{let t=l.current;if(!t)return;function i(){J(Y.current,{[L.Forwards]:()=>{var s;G(t,A.First)===pe.Error&&((s=r.afterPanelSentinel.current)==null||s.focus())},[L.Backwards]:()=>{var s;(s=r.button)==null||s.focus({preventScroll:!0})}})}i()}),z=E(()=>{let t=l.current;if(!t)return;function i(){J(Y.current,{[L.Forwards]:()=>{if(!r.button)return;let s=de(),C=s.indexOf(r.button),R=s.slice(0,C+1),T=[...s.slice(C+1),...R];for(let D of T.slice())if(D.dataset.headlessuiFocusGuard==="true"||O!=null&&O.contains(D)){let be=T.indexOf(D);be!==-1&&T.splice(be,1)}G(T,A.First,{sorted:!1})},[L.Backwards]:()=>{var s;G(t,A.Previous)===pe.Error&&((s=r.button)==null||s.focus())}})}i()}),u=ee();return m.createElement(tt,null,m.createElement(le.Provider,{value:g},m.createElement(ae.Provider,{value:{close:f,isPortalled:h}},m.createElement(Ve,{enabled:$?e.static||B:!1},B&&h&&m.createElement(se,{id:I,ref:r.beforePanelSentinel,features:ie.Focusable,"data-headlessui-focus-guard":!0,as:"button",type:"button",onFocus:Z}),u({ourProps:Q,theirProps:x,slot:N,defaultTag:bt,features:St,visible:B,name:"Popover.Panel"}),B&&h&&m.createElement(se,{id:b,ref:r.afterPanelSentinel,features:ie.Focusable,"data-headlessui-focus-guard":!0,as:"button",type:"button",onFocus:z})))))}let Et="div";function gt(e,n){let p=o.useRef(null),g=V(p,n),[d,y]=o.useState([]),$=E(b=>{y(l=>{let c=l.indexOf(b);if(c!==-1){let S=l.slice();return S.splice(c,1),S}return l})}),a=E(b=>(y(l=>[...l,b]),()=>$(b))),v=E(()=>{var b;let l=Ue(p);if(!l)return!1;let c=l.activeElement;return(b=p.current)!=null&&b.contains(c)?!0:d.some(S=>{var F,k;return((F=l.getElementById(S.buttonId.current))==null?void 0:F.contains(c))||((k=l.getElementById(S.panelId.current))==null?void 0:k.contains(c))})}),x=E(b=>{for(let l of d)l.buttonId.current!==b&&l.close()}),r=o.useMemo(()=>({registerPopover:a,unregisterPopover:$,isFocusWithinPopoverGroup:v,closeOthers:x}),[a,$,v,x]),P=o.useMemo(()=>({}),[]),f=e,h={ref:g},I=ee();return m.createElement(he,null,m.createElement(me.Provider,{value:r},I({ourProps:h,theirProps:f,slot:P,defaultTag:Et,name:"Popover.Group"})))}let $t=X(dt),Re=X(vt),ht=X(Be),It=X(Be),Fe=X(yt),xt=X(gt),Tt=Object.assign($t,{Button:Re,Backdrop:It,Overlay:ht,Panel:Fe,Group:xt});const Pe=o.forwardRef(({anchor:e,buttonProps:n,className:p,popoverClassName:g,popoverComponent:d,portal:y},$)=>re.jsxs(Tt,{className:p,ref:$,children:[re.jsx(Re,{as:Oe,...n}),re.jsx(Fe,{as:"div",anchor:e,portal:y,transition:!0,className:ke("flex origin-top flex-col rounded-box p-2 shadow-lg transition duration-200 ease-out data-[closed]:scale-95 data-[closed]:opacity-0",g),children:d})]}));Pe.displayName="Popover";Pe.__docgenInfo={description:"",methods:[],displayName:"Popover",props:{anchor:{required:!1,tsType:{name:"AnchorProps"},description:""},buttonProps:{required:!0,tsType:{name:"ButtonProps"},description:""},className:{required:!1,tsType:{name:"string"},description:""},popoverClassName:{required:!1,tsType:{name:"string"},description:""},popoverComponent:{required:!0,tsType:{name:"signature",type:"function",raw:"({ open, close }: PopoverPanelRenderProps) => JSX.Element",signature:{arguments:[{type:{name:"PopoverPanelRenderProps"},name:""}],return:{name:"JSX.Element"}}},description:""},portal:{required:!1,tsType:{name:"boolean"},description:""}},composes:["Omit"]};const Jt={title:"Popover",component:Pe},te={args:{anchor:"bottom start",buttonProps:{children:"Open Popover"},className:"mb-24",popoverComponent:()=>re.jsx("div",{className:"w-64",children:"Test Lmao"})}};var ye,Ee,ge;te.parameters={...te.parameters,docs:{...(ye=te.parameters)==null?void 0:ye.docs,source:{originalSource:`{
  args: {
    anchor: 'bottom start',
    buttonProps: {
      children: 'Open Popover'
    },
    className: 'mb-24',
    popoverComponent: () => <div className="w-64">Test Lmao</div>
  }
}`,...(ge=(Ee=te.parameters)==null?void 0:Ee.docs)==null?void 0:ge.source}}};const Ht=["Default"];export{te as Default,Ht as __namedExportsOrder,Jt as default};
