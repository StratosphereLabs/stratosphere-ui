import{j}from"./jsx-runtime-DR9Q75dM.js";import{c as me}from"./index-lhGYx47h.js";import{r as l,R as T}from"./index-DRjF_FHU.js";import{B as we}from"./Button-C8Er2sLW.js";import{S as te,D as X,y as W,T as Ce,s as fe,a as E,u as G,X as J,I as H,l as Ne,b as L,e as Oe}from"./use-is-mounted-BwivAQE6.js";import{r as he}from"./bugs-BqEXq7dn.js";import{f as ue,O as q,M as D,h as Be,T as ke,N as ne}from"./focus-management-D-lBgQCa.js";import{c as Re,d as K,C as $e}from"./open-closed-DSFNRtpz.js";import{s as Fe}from"./use-resolve-button-type-hEnF6IRh.js";import{h as Me}from"./use-outside-click-ryvoS0Jt.js";import{n as se}from"./use-owner-DSsMAH39.js";import{a as De,j as _e,E as Le,n as Te,y as je,s as _}from"./use-root-containers-i4FLLUUy.js";import{c as ae,p as le}from"./hidden-tij90rwi.js";import{t as qe}from"./transition-CuZKXbF5.js";import"./index-rX-Bn4lm.js";import"./use-flags-uZipNKZX.js";var Ge=(e=>(e[e.Open=0]="Open",e[e.Closed=1]="Closed",e))(Ge||{}),He=(e=>(e[e.TogglePopover=0]="TogglePopover",e[e.ClosePopover=1]="ClosePopover",e[e.SetButton=2]="SetButton",e[e.SetButtonId=3]="SetButtonId",e[e.SetPanel=4]="SetPanel",e[e.SetPanelId=5]="SetPanelId",e))(He||{});let We={0:e=>{let r={...e,popoverState:G(e.popoverState,{0:1,1:0})};return r.popoverState===0&&(r.__demoMode=!1),r},1(e){return e.popoverState===1?e:{...e,popoverState:1}},2(e,r){return e.button===r.button?e:{...e,button:r.button}},3(e,r){return e.buttonId===r.buttonId?e:{...e,buttonId:r.buttonId}},4(e,r){return e.panel===r.panel?e:{...e,panel:r.panel}},5(e,r){return e.panelId===r.panelId?e:{...e,panelId:r.panelId}}},pe=l.createContext(null);pe.displayName="PopoverContext";function re(e){let r=l.useContext(pe);if(r===null){let c=new Error(`<${e} /> is missing a parent <Popover /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(c,re),c}return r}let ie=l.createContext(null);ie.displayName="PopoverAPIContext";function ce(e){let r=l.useContext(ie);if(r===null){let c=new Error(`<${e} /> is missing a parent <Popover /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(c,ce),c}return r}let de=l.createContext(null);de.displayName="PopoverGroupContext";function Ie(){return l.useContext(de)}let oe=l.createContext(null);oe.displayName="PopoverPanelContext";function Ke(){return l.useContext(oe)}function ze(e,r){return G(r.type,We,e,r)}let Xe="div";function Je(e,r){var c;let{__demoMode:y=!1,...h}=e,a=l.useRef(null),t=W(r,Ce(s=>{a.current=s})),f=l.useRef([]),P=l.useReducer(ze,{__demoMode:y,popoverState:y?0:1,buttons:f,button:null,buttonId:null,panel:null,panelId:null,beforePanelSentinel:l.createRef(),afterPanelSentinel:l.createRef()}),[{popoverState:g,button:i,buttonId:$,panel:n,panelId:R,beforePanelSentinel:w,afterPanelSentinel:S},u]=P,b=se((c=a.current)!=null?c:i),x=l.useMemo(()=>{if(!i||!n)return!1;for(let Y of document.querySelectorAll("body > *"))if(Number(Y==null?void 0:Y.contains(i))^Number(Y==null?void 0:Y.contains(n)))return!0;let s=ue(),C=s.indexOf(i),U=(C+s.length-1)%s.length,z=(C+1)%s.length,V=s[U],xe=s[z];return!n.contains(V)&&!n.contains(xe)},[i,n]),N=fe($),O=fe(R),F=l.useMemo(()=>({buttonId:N,panelId:O,close:()=>u({type:1})}),[N,O,u]),B=Ie(),p=B==null?void 0:B.registerPopover,I=E(()=>{var s;return(s=B==null?void 0:B.isFocusWithinPopoverGroup())!=null?s:(b==null?void 0:b.activeElement)&&((i==null?void 0:i.contains(b.activeElement))||(n==null?void 0:n.contains(b.activeElement)))});l.useEffect(()=>p==null?void 0:p(F),[p,F]);let[d,k]=De(),o=_e({mainTreeNodeRef:B==null?void 0:B.mainTreeNodeRef,portals:d,defaultContainers:[i,n]});Le(b==null?void 0:b.defaultView,"focus",s=>{var C,U,z,V;s.target!==window&&s.target instanceof HTMLElement&&g===0&&(I()||i&&n&&(o.contains(s.target)||(U=(C=w.current)==null?void 0:C.contains)!=null&&U.call(C,s.target)||(V=(z=S.current)==null?void 0:z.contains)!=null&&V.call(z,s.target)||u({type:1})))},!0),Me(o.resolveContainers,(s,C)=>{u({type:1}),Be(C,ke.Loose)||(s.preventDefault(),i==null||i.focus())},g===0);let v=E(s=>{u({type:1});let C=s?s instanceof HTMLElement?s:"current"in s&&s.current instanceof HTMLElement?s.current:i:i;C==null||C.focus()}),m=l.useMemo(()=>({close:v,isPortalled:x}),[v,x]),M=l.useMemo(()=>({open:g===0,close:v}),[g,v]),A={ref:t};return T.createElement(oe.Provider,{value:null},T.createElement(pe.Provider,{value:P},T.createElement(ie.Provider,{value:m},T.createElement(Re,{value:G(g,{0:K.Open,1:K.Closed})},T.createElement(k,null,J({ourProps:A,theirProps:h,slot:M,defaultTag:Xe,name:"Popover"}),T.createElement(o.MainTreeNode,null))))))}let Ae="button";function Ue(e,r){let c=H(),{id:y=`headlessui-popover-button-${c}`,...h}=e,[a,t]=re("Popover.Button"),{isPortalled:f}=ce("Popover.Button"),P=l.useRef(null),g=`headlessui-focus-sentinel-${H()}`,i=Ie(),$=i==null?void 0:i.closeOthers,n=Ke()!==null;l.useEffect(()=>{if(!n)return t({type:3,buttonId:y}),()=>{t({type:3,buttonId:null})}},[n,y,t]);let[R]=l.useState(()=>Symbol()),w=W(P,r,n?null:o=>{if(o)a.buttons.current.push(R);else{let v=a.buttons.current.indexOf(R);v!==-1&&a.buttons.current.splice(v,1)}a.buttons.current.length>1&&console.warn("You are already using a <Popover.Button /> but only 1 <Popover.Button /> is supported."),o&&t({type:2,button:o})}),S=W(P,r),u=se(P),b=E(o=>{var v,m,M;if(n){if(a.popoverState===1)return;switch(o.key){case L.Space:case L.Enter:o.preventDefault(),(m=(v=o.target).click)==null||m.call(v),t({type:1}),(M=a.button)==null||M.focus();break}}else switch(o.key){case L.Space:case L.Enter:o.preventDefault(),o.stopPropagation(),a.popoverState===1&&($==null||$(a.buttonId)),t({type:0});break;case L.Escape:if(a.popoverState!==0)return $==null?void 0:$(a.buttonId);if(!P.current||u!=null&&u.activeElement&&!P.current.contains(u.activeElement))return;o.preventDefault(),o.stopPropagation(),t({type:1});break}}),x=E(o=>{n||o.key===L.Space&&o.preventDefault()}),N=E(o=>{var v,m;he(o.currentTarget)||e.disabled||(n?(t({type:1}),(v=a.button)==null||v.focus()):(o.preventDefault(),o.stopPropagation(),a.popoverState===1&&($==null||$(a.buttonId)),t({type:0}),(m=a.button)==null||m.focus()))}),O=E(o=>{o.preventDefault(),o.stopPropagation()}),F=a.popoverState===0,B=l.useMemo(()=>({open:F}),[F]),p=Fe(e,P),I=n?{ref:S,type:p,onKeyDown:b,onClick:N}:{ref:w,id:a.buttonId,type:p,"aria-expanded":a.popoverState===0,"aria-controls":a.panel?a.panelId:void 0,onKeyDown:b,onKeyUp:x,onClick:N,onMouseDown:O},d=Te(),k=E(()=>{let o=a.panel;if(!o)return;function v(){G(d.current,{[_.Forwards]:()=>q(o,D.First),[_.Backwards]:()=>q(o,D.Last)})===ne.Error&&q(ue().filter(m=>m.dataset.headlessuiFocusGuard!=="true"),G(d.current,{[_.Forwards]:D.Next,[_.Backwards]:D.Previous}),{relativeTo:a.button})}v()});return T.createElement(T.Fragment,null,J({ourProps:I,theirProps:h,slot:B,defaultTag:Ae,name:"Popover.Button"}),F&&!n&&f&&T.createElement(ae,{id:g,features:le.Focusable,"data-headlessui-focus-guard":!0,as:"button",type:"button",onFocus:k}))}let Ve="div",Ye=te.RenderStrategy|te.Static;function Qe(e,r){let c=H(),{id:y=`headlessui-popover-overlay-${c}`,...h}=e,[{popoverState:a},t]=re("Popover.Overlay"),f=W(r),P=$e(),g=P!==null?(P&K.Open)===K.Open:a===0,i=E(n=>{if(he(n.currentTarget))return n.preventDefault();t({type:1})}),$=l.useMemo(()=>({open:a===0}),[a]);return J({ourProps:{ref:f,id:y,"aria-hidden":!0,onClick:i},theirProps:h,slot:$,defaultTag:Ve,features:Ye,visible:g,name:"Popover.Overlay"})}let Ze="div",et=te.RenderStrategy|te.Static;function tt(e,r){let c=H(),{id:y=`headlessui-popover-panel-${c}`,focus:h=!1,...a}=e,[t,f]=re("Popover.Panel"),{close:P,isPortalled:g}=ce("Popover.Panel"),i=`headlessui-focus-sentinel-before-${H()}`,$=`headlessui-focus-sentinel-after-${H()}`,n=l.useRef(null),R=W(n,r,p=>{f({type:4,panel:p})}),w=se(n);Ne(()=>(f({type:5,panelId:y}),()=>{f({type:5,panelId:null})}),[y,f]);let S=$e(),u=S!==null?(S&K.Open)===K.Open:t.popoverState===0,b=E(p=>{var I;switch(p.key){case L.Escape:if(t.popoverState!==0||!n.current||w!=null&&w.activeElement&&!n.current.contains(w.activeElement))return;p.preventDefault(),p.stopPropagation(),f({type:1}),(I=t.button)==null||I.focus();break}});l.useEffect(()=>{var p;e.static||t.popoverState===1&&((p=e.unmount)==null||p)&&f({type:4,panel:null})},[t.popoverState,e.unmount,e.static,f]),l.useEffect(()=>{if(t.__demoMode||!h||t.popoverState!==0||!n.current)return;let p=w==null?void 0:w.activeElement;n.current.contains(p)||q(n.current,D.First)},[t.__demoMode,h,n,t.popoverState]);let x=l.useMemo(()=>({open:t.popoverState===0,close:P}),[t,P]),N={ref:R,id:y,onKeyDown:b,onBlur:h&&t.popoverState===0?p=>{var I,d,k,o,v;let m=p.relatedTarget;m&&n.current&&((I=n.current)!=null&&I.contains(m)||(f({type:1}),((k=(d=t.beforePanelSentinel.current)==null?void 0:d.contains)!=null&&k.call(d,m)||(v=(o=t.afterPanelSentinel.current)==null?void 0:o.contains)!=null&&v.call(o,m))&&m.focus({preventScroll:!0})))}:void 0,tabIndex:-1},O=Te(),F=E(()=>{let p=n.current;if(!p)return;function I(){G(O.current,{[_.Forwards]:()=>{var d;q(p,D.First)===ne.Error&&((d=t.afterPanelSentinel.current)==null||d.focus())},[_.Backwards]:()=>{var d;(d=t.button)==null||d.focus({preventScroll:!0})}})}I()}),B=E(()=>{let p=n.current;if(!p)return;function I(){G(O.current,{[_.Forwards]:()=>{var d;if(!t.button)return;let k=ue(),o=k.indexOf(t.button),v=k.slice(0,o+1),m=[...k.slice(o+1),...v];for(let M of m.slice())if(M.dataset.headlessuiFocusGuard==="true"||(d=t.panel)!=null&&d.contains(M)){let A=m.indexOf(M);A!==-1&&m.splice(A,1)}q(m,D.First,{sorted:!1})},[_.Backwards]:()=>{var d;q(p,D.Previous)===ne.Error&&((d=t.button)==null||d.focus())}})}I()});return T.createElement(oe.Provider,{value:y},u&&g&&T.createElement(ae,{id:i,ref:t.beforePanelSentinel,features:le.Focusable,"data-headlessui-focus-guard":!0,as:"button",type:"button",onFocus:F}),J({ourProps:N,theirProps:a,slot:x,defaultTag:Ze,features:et,visible:u,name:"Popover.Panel"}),u&&g&&T.createElement(ae,{id:$,ref:t.afterPanelSentinel,features:le.Focusable,"data-headlessui-focus-guard":!0,as:"button",type:"button",onFocus:B}))}let rt="div";function ot(e,r){let c=l.useRef(null),y=W(c,r),[h,a]=l.useState([]),t=je(),f=E(S=>{a(u=>{let b=u.indexOf(S);if(b!==-1){let x=u.slice();return x.splice(b,1),x}return u})}),P=E(S=>(a(u=>[...u,S]),()=>f(S))),g=E(()=>{var S;let u=Oe(c);if(!u)return!1;let b=u.activeElement;return(S=c.current)!=null&&S.contains(b)?!0:h.some(x=>{var N,O;return((N=u.getElementById(x.buttonId.current))==null?void 0:N.contains(b))||((O=u.getElementById(x.panelId.current))==null?void 0:O.contains(b))})}),i=E(S=>{for(let u of h)u.buttonId.current!==S&&u.close()}),$=l.useMemo(()=>({registerPopover:P,unregisterPopover:f,isFocusWithinPopoverGroup:g,closeOthers:i,mainTreeNodeRef:t.mainTreeNodeRef}),[P,f,g,i,t.mainTreeNodeRef]),n=l.useMemo(()=>({}),[]),R=e,w={ref:y};return T.createElement(de.Provider,{value:$},J({ourProps:w,theirProps:R,slot:n,defaultTag:rt,name:"Popover.Group"}),T.createElement(t.MainTreeNode,null))}let nt=X(Je),at=X(Ue),lt=X(Qe),ut=X(tt),st=X(ot),Q=Object.assign(nt,{Button:at,Overlay:lt,Panel:ut,Group:st});const ve=l.forwardRef(({buttonProps:e,className:r,popoverClassName:c,popoverComponent:y,withBackdrop:h,...a},t)=>j.jsxs(Q,{as:"div",className:me("relative",r),ref:t,...a,children:[j.jsx(Q.Button,{as:we,...e}),h?j.jsx(Q.Overlay,{className:"fixed inset-0 bg-black opacity-30"}):null,j.jsx(qe,{as:l.Fragment,enter:"transition duration-100 ease-out",enterFrom:"transform scale-95 opacity-0",enterTo:"transform scale-100 opacity-100",leave:"transition duration-75 ease-out",leaveFrom:"transform scale-100 opacity-100",leaveTo:"transform scale-95 opacity-0",children:j.jsx(Q.Panel,{as:"div",className:me("absolute z-50 bg-base-100 p-2 shadow-xl",c),children:y})})]}));ve.displayName="Popover";ve.__docgenInfo={description:"",methods:[],displayName:"Popover",props:{buttonProps:{required:!0,tsType:{name:"ButtonProps"},description:""},className:{required:!1,tsType:{name:"string"},description:""},popoverClassName:{required:!1,tsType:{name:"string"},description:""},popoverComponent:{required:!0,tsType:{name:"signature",type:"function",raw:"({ open, close }: PopoverPanelRenderProps) => JSX.Element",signature:{arguments:[{type:{name:"PopoverPanelRenderProps"},name:""}],return:{name:"JSX.Element"}}},description:""},withBackdrop:{required:!1,tsType:{name:"boolean"},description:""}},composes:["Omit"]};const It={title:"Popover",component:ve},Z={args:{buttonProps:{children:"Open Popover"},className:"mb-24",popoverComponent:()=>j.jsx("div",{className:"w-64",children:"Test Lmao"})}},ee={args:{buttonProps:{children:"Open Popover"},className:"mb-24",popoverComponent:()=>j.jsx("div",{className:"w-64",children:"Test Lmao"}),withBackdrop:!0}};var Pe,be,ye;Z.parameters={...Z.parameters,docs:{...(Pe=Z.parameters)==null?void 0:Pe.docs,source:{originalSource:`{
  args: {
    buttonProps: {
      children: 'Open Popover'
    },
    className: 'mb-24',
    popoverComponent: () => <div className="w-64">Test Lmao</div>
  }
}`,...(ye=(be=Z.parameters)==null?void 0:be.docs)==null?void 0:ye.source}}};var Se,ge,Ee;ee.parameters={...ee.parameters,docs:{...(Se=ee.parameters)==null?void 0:Se.docs,source:{originalSource:`{
  args: {
    buttonProps: {
      children: 'Open Popover'
    },
    className: 'mb-24',
    popoverComponent: () => <div className="w-64">Test Lmao</div>,
    withBackdrop: true
  }
}`,...(Ee=(ge=ee.parameters)==null?void 0:ge.docs)==null?void 0:Ee.source}}};const xt=["Default","WithBackdrop"];export{Z as Default,ee as WithBackdrop,xt as __namedExportsOrder,It as default};
